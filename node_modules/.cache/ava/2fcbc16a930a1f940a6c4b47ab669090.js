'use strict';

var _ava = require('ava');

var _ava2 = _interopRequireDefault(_ava);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var _Needs = require('./index.js');

(0, _ava2.default)(function (t) {
    testStrictCorrect(t);
    testStrictIncorrect(t);
    t.pass();
});

function testStrictCorrect(t) {
    var needs = _Needs({});
    var test = needs.params({
        a: 'int',
        b_: 'float',
        c: {
            d_: 'int[]',
            e: {
                f: 'str',
                g: 'datetime'
            }
        }
    });
    return test({
        body: {
            a: 42,
            b: 3.14,
            c: {
                e: {
                    f: 'test',
                    g: Date.now()
                }
            }
        }
    }, null, function (err) {
        if (err) {
            console.log('testStrictCorrect', err);
            t.fail();
        }
    });
}
function testStrictIncorrect(t) {
    var needs = _Needs({ onError: function onError(options) {
            return 'Successful Error Test';
        } });
    var test = needs.params({
        a: 'int',
        b_: 'float',
        c: {
            d_: 'int[]',
            e: {
                f: 'str',
                g: 'datetime'
            }
        }
    });
    return test({
        body: {
            a: 42,
            b: 3.14,
            c: {
                e: {
                    f: 'test',
                    g: Date.now()
                },
                f: 1
            }
        }
    }, null, function (err) {
        if (!err || err.expected) {
            console.log('testStrictIncorrect', err);
            t.fail();
        }
    });
}